<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Advanced Visualizations | R Crash Course</title>
  <meta name="description" content="A Crash Course in R for Biologists" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Advanced Visualizations | R Crash Course" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A Crash Course in R for Biologists" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Advanced Visualizations | R Crash Course" />
  
  <meta name="twitter:description" content="A Crash Course in R for Biologists" />
  

<meta name="author" content="Robert I. Colautti" />


<meta name="date" content="2021-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quick-visualizations.html"/>
<link rel="next" href="regular-expressions.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> Setup</a></li>
<li class="chapter" data-level="2" data-path="fundamentals.html"><a href="fundamentals.html"><i class="fa fa-check"></i><b>2</b> Fundamentals</a>
<ul>
<li class="chapter" data-level="2.1" data-path="fundamentals.html"><a href="fundamentals.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="fundamentals.html"><a href="fundamentals.html#r-basics"><i class="fa fa-check"></i><b>2.2</b> R Basics</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="fundamentals.html"><a href="fundamentals.html#basic-math"><i class="fa fa-check"></i><b>2.2.1</b> Basic Math</a></li>
<li class="chapter" data-level="2.2.2" data-path="fundamentals.html"><a href="fundamentals.html#functions"><i class="fa fa-check"></i><b>2.2.2</b> Functions</a></li>
<li class="chapter" data-level="2.2.3" data-path="fundamentals.html"><a href="fundamentals.html#c"><i class="fa fa-check"></i><b>2.2.3</b> `c()</a></li>
<li class="chapter" data-level="2.2.4" data-path="fundamentals.html"><a href="fundamentals.html#math-functions"><i class="fa fa-check"></i><b>2.2.4</b> Math Functions</a></li>
<li class="chapter" data-level="2.2.5" data-path="fundamentals.html"><a href="fundamentals.html#roundtruncate"><i class="fa fa-check"></i><b>2.2.5</b> Round/Truncate</a></li>
<li class="chapter" data-level="2.2.6" data-path="fundamentals.html"><a href="fundamentals.html#logic-operators"><i class="fa fa-check"></i><b>2.2.6</b> Logic Operators</a></li>
<li class="chapter" data-level="2.2.7" data-path="fundamentals.html"><a href="fundamentals.html#group-comparison"><i class="fa fa-check"></i><b>2.2.7</b> Group Comparison</a></li>
<li class="chapter" data-level="2.2.8" data-path="fundamentals.html"><a href="fundamentals.html#random-numbers"><i class="fa fa-check"></i><b>2.2.8</b> Random Numbers</a></li>
<li class="chapter" data-level="2.2.9" data-path="fundamentals.html"><a href="fundamentals.html#combining-objects"><i class="fa fa-check"></i><b>2.2.9</b> Combining objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="fundamentals.html"><a href="fundamentals.html#data-types"><i class="fa fa-check"></i><b>2.3</b> Data Types</a></li>
<li class="chapter" data-level="2.4" data-path="fundamentals.html"><a href="fundamentals.html#objects"><i class="fa fa-check"></i><b>2.4</b> Objects</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="fundamentals.html"><a href="fundamentals.html#cells"><i class="fa fa-check"></i><b>2.4.1</b> Cells</a></li>
<li class="chapter" data-level="2.4.2" data-path="fundamentals.html"><a href="fundamentals.html#vector"><i class="fa fa-check"></i><b>2.4.2</b> Vector</a></li>
<li class="chapter" data-level="2.4.3" data-path="fundamentals.html"><a href="fundamentals.html#matrices"><i class="fa fa-check"></i><b>2.4.3</b> Matrices</a></li>
<li class="chapter" data-level="2.4.4" data-path="fundamentals.html"><a href="fundamentals.html#tensors"><i class="fa fa-check"></i><b>2.4.4</b> Tensors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="fundamentals.html"><a href="fundamentals.html#matrix-algebra"><i class="fa fa-check"></i><b>2.5</b> Matrix Algebra</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="fundamentals.html"><a href="fundamentals.html#pca"><i class="fa fa-check"></i><b>2.5.1</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="fundamentals.html"><a href="fundamentals.html#lists"><i class="fa fa-check"></i><b>2.6</b> Lists</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="fundamentals.html"><a href="fundamentals.html#subset-1"><i class="fa fa-check"></i><b>2.6.1</b> Subset</a></li>
<li class="chapter" data-level="2.6.2" data-path="fundamentals.html"><a href="fundamentals.html#output"><i class="fa fa-check"></i><b>2.6.2</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="fundamentals.html"><a href="fundamentals.html#print-and-paste"><i class="fa fa-check"></i><b>2.7</b> <code>print()</code> and <code>paste()</code></a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="fundamentals.html"><a href="fundamentals.html#for-help"><i class="fa fa-check"></i><b>2.7.1</b> ? for HELP</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="fundamentals.html"><a href="fundamentals.html#data"><i class="fa fa-check"></i><b>2.8</b> Data</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="fundamentals.html"><a href="fundamentals.html#working-directory"><i class="fa fa-check"></i><b>2.8.1</b> Working Directory</a></li>
<li class="chapter" data-level="2.8.2" data-path="fundamentals.html"><a href="fundamentals.html#import"><i class="fa fa-check"></i><b>2.8.2</b> Import</a></li>
<li class="chapter" data-level="2.8.3" data-path="fundamentals.html"><a href="fundamentals.html#data.frame"><i class="fa fa-check"></i><b>2.8.3</b> <code>data.frame</code></a></li>
<li class="chapter" data-level="2.8.4" data-path="fundamentals.html"><a href="fundamentals.html#subset-2"><i class="fa fa-check"></i><b>2.8.4</b> Subset</a></li>
<li class="chapter" data-level="2.8.5" data-path="fundamentals.html"><a href="fundamentals.html#new-columns"><i class="fa fa-check"></i><b>2.8.5</b> New Columns</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="fundamentals.html"><a href="fundamentals.html#other-functions"><i class="fa fa-check"></i><b>2.9</b> Other Functions</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="fundamentals.html"><a href="fundamentals.html#unique"><i class="fa fa-check"></i><b>2.9.1</b> <code>unique</code></a></li>
<li class="chapter" data-level="2.9.2" data-path="fundamentals.html"><a href="fundamentals.html#duplicated"><i class="fa fa-check"></i><b>2.9.2</b> <code>duplicated</code></a></li>
<li class="chapter" data-level="2.9.3" data-path="fundamentals.html"><a href="fundamentals.html#aggregate"><i class="fa fa-check"></i><b>2.9.3</b> <code>aggregate</code></a></li>
<li class="chapter" data-level="2.9.4" data-path="fundamentals.html"><a href="fundamentals.html#tapply"><i class="fa fa-check"></i><b>2.9.4</b> tapply</a></li>
<li class="chapter" data-level="2.9.5" data-path="fundamentals.html"><a href="fundamentals.html#save"><i class="fa fa-check"></i><b>2.9.5</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="fundamentals.html"><a href="fundamentals.html#flow-control"><i class="fa fa-check"></i><b>2.10</b> Flow control</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="fundamentals.html"><a href="fundamentals.html#if"><i class="fa fa-check"></i><b>2.10.1</b> <code>if</code></a></li>
<li class="chapter" data-level="2.10.2" data-path="fundamentals.html"><a href="fundamentals.html#ifelse"><i class="fa fa-check"></i><b>2.10.2</b> ifelse</a></li>
<li class="chapter" data-level="2.10.3" data-path="fundamentals.html"><a href="fundamentals.html#for-loop"><i class="fa fa-check"></i><b>2.10.3</b> <code>for</code> loop</a></li>
<li class="chapter" data-level="2.10.4" data-path="fundamentals.html"><a href="fundamentals.html#nested-loops"><i class="fa fa-check"></i><b>2.10.4</b> Nested Loops</a></li>
<li class="chapter" data-level="2.10.5" data-path="fundamentals.html"><a href="fundamentals.html#while-loop"><i class="fa fa-check"></i><b>2.10.5</b> <code>while</code> loop</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="fundamentals.html"><a href="fundamentals.html#packages"><i class="fa fa-check"></i><b>2.11</b> Packages</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="fundamentals.html"><a href="fundamentals.html#installing"><i class="fa fa-check"></i><b>2.11.1</b> Installing</a></li>
<li class="chapter" data-level="2.11.2" data-path="fundamentals.html"><a href="fundamentals.html#loading"><i class="fa fa-check"></i><b>2.11.2</b> Loading</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="fundamentals.html"><a href="fundamentals.html#readable-code"><i class="fa fa-check"></i><b>2.12</b> Readable code</a></li>
<li class="chapter" data-level="2.13" data-path="fundamentals.html"><a href="fundamentals.html#test-yourself"><i class="fa fa-check"></i><b>2.13</b> TEST yourself:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="quick-visualizations.html"><a href="quick-visualizations.html"><i class="fa fa-check"></i><b>3</b> Quick Visualizations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#graphical-concepts"><i class="fa fa-check"></i><b>3.1.1</b> Graphical Concepts</a></li>
<li class="chapter" data-level="3.1.2" data-path="quick-visualizations.html"><a href="quick-visualizations.html#vector-vs.-raster"><i class="fa fa-check"></i><b>3.1.2</b> Vector vs. Raster</a></li>
<li class="chapter" data-level="3.1.3" data-path="quick-visualizations.html"><a href="quick-visualizations.html#resolution-vs-dimension"><i class="fa fa-check"></i><b>3.1.3</b> Resolution vs Dimension</a></li>
<li class="chapter" data-level="3.1.4" data-path="quick-visualizations.html"><a href="quick-visualizations.html#screen-vs-print"><i class="fa fa-check"></i><b>3.1.4</b> Screen vs Print</a></li>
<li class="chapter" data-level="3.1.5" data-path="quick-visualizations.html"><a href="quick-visualizations.html#accessibility"><i class="fa fa-check"></i><b>3.1.5</b> Accessibility</a></li>
<li class="chapter" data-level="3.1.6" data-path="quick-visualizations.html"><a href="quick-visualizations.html#slides"><i class="fa fa-check"></i><b>3.1.6</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="quick-visualizations.html"><a href="quick-visualizations.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#data-setup"><i class="fa fa-check"></i><b>3.2.1</b> Data setup</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="quick-visualizations.html"><a href="quick-visualizations.html#basic-graphs"><i class="fa fa-check"></i><b>3.3</b> Basic Graphs</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#one-continuous"><i class="fa fa-check"></i><b>3.3.1</b> One continuous</a></li>
<li class="chapter" data-level="3.3.2" data-path="quick-visualizations.html"><a href="quick-visualizations.html#one-categorical"><i class="fa fa-check"></i><b>3.3.2</b> One categorical</a></li>
<li class="chapter" data-level="3.3.3" data-path="quick-visualizations.html"><a href="quick-visualizations.html#two-continuous"><i class="fa fa-check"></i><b>3.3.3</b> Two continuous</a></li>
<li class="chapter" data-level="3.3.4" data-path="quick-visualizations.html"><a href="quick-visualizations.html#two-categorical"><i class="fa fa-check"></i><b>3.3.4</b> Two categorical</a></li>
<li class="chapter" data-level="3.3.5" data-path="quick-visualizations.html"><a href="quick-visualizations.html#categorical-by-continuous"><i class="fa fa-check"></i><b>3.3.5</b> Categorical by continuous</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="quick-visualizations.html"><a href="quick-visualizations.html#basic-customization"><i class="fa fa-check"></i><b>3.4</b> Basic customization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#binwidth"><i class="fa fa-check"></i><b>3.4.1</b> <code>binwidth</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="quick-visualizations.html"><a href="quick-visualizations.html#size"><i class="fa fa-check"></i><b>3.4.2</b> <code>size</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="quick-visualizations.html"><a href="quick-visualizations.html#colour-or-color"><i class="fa fa-check"></i><b>3.4.3</b> <code>colour</code> or <code>color</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="quick-visualizations.html"><a href="quick-visualizations.html#fill"><i class="fa fa-check"></i><b>3.4.4</b> <code>fill</code></a></li>
<li class="chapter" data-level="3.4.5" data-path="quick-visualizations.html"><a href="quick-visualizations.html#posit"><i class="fa fa-check"></i><b>3.4.5</b> <code>posit</code></a></li>
<li class="chapter" data-level="3.4.6" data-path="quick-visualizations.html"><a href="quick-visualizations.html#alpha"><i class="fa fa-check"></i><b>3.4.6</b> <code>alpha</code></a></li>
<li class="chapter" data-level="3.4.7" data-path="quick-visualizations.html"><a href="quick-visualizations.html#shape"><i class="fa fa-check"></i><b>3.4.7</b> <code>shape</code></a></li>
<li class="chapter" data-level="3.4.8" data-path="quick-visualizations.html"><a href="quick-visualizations.html#lab-xlab-and-ylab"><i class="fa fa-check"></i><b>3.4.8</b> <code>lab</code>, <code>xlab</code>, and <code>ylab</code></a></li>
<li class="chapter" data-level="3.4.9" data-path="quick-visualizations.html"><a href="quick-visualizations.html#main"><i class="fa fa-check"></i><b>3.4.9</b> <code>main</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="quick-visualizations.html"><a href="quick-visualizations.html#themes-and-geoms"><i class="fa fa-check"></i><b>3.5</b> Themes and Geoms</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#theme_name"><i class="fa fa-check"></i><b>3.5.1</b> <code>+ theme_NAME()</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="quick-visualizations.html"><a href="quick-visualizations.html#theme_set"><i class="fa fa-check"></i><b>3.5.2</b> <code>theme_set</code></a></li>
<li class="chapter" data-level="3.5.3" data-path="quick-visualizations.html"><a href="quick-visualizations.html#geom"><i class="fa fa-check"></i><b>3.5.3</b> <code>geom</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="quick-visualizations.html"><a href="quick-visualizations.html#multiple-graphs"><i class="fa fa-check"></i><b>3.6</b> Multiple graphs</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="quick-visualizations.html"><a href="quick-visualizations.html#facets"><i class="fa fa-check"></i><b>3.6.1</b> <code>facets</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="quick-visualizations.html"><a href="quick-visualizations.html#save-output"><i class="fa fa-check"></i><b>3.7</b> Save output</a></li>
<li class="chapter" data-level="3.8" data-path="quick-visualizations.html"><a href="quick-visualizations.html#practice"><i class="fa fa-check"></i><b>3.8</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html"><i class="fa fa-check"></i><b>4</b> Advanced Visualizations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#getting-started-1"><i class="fa fa-check"></i><b>4.2</b> Getting Started</a></li>
<li class="chapter" data-level="4.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#rules-of-thumb"><i class="fa fa-check"></i><b>4.3</b> Rules of thumb</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#minimize-ink"><i class="fa fa-check"></i><b>4.3.1</b> 1. Minimize ‘ink’</a></li>
<li class="chapter" data-level="4.3.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#use-space-wisely"><i class="fa fa-check"></i><b>4.3.2</b> 2. Use space wisely</a></li>
<li class="chapter" data-level="4.3.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#choose-a-colour-palette"><i class="fa fa-check"></i><b>4.3.3</b> 3. Choose a colour palette</a></li>
<li class="chapter" data-level="4.3.4" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#colours-have-meaning"><i class="fa fa-check"></i><b>4.3.4</b> 4. Colours have meaning</a></li>
<li class="chapter" data-level="4.3.5" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#maximize-contrast"><i class="fa fa-check"></i><b>4.3.5</b> 5. Maximize contrast</a></li>
<li class="chapter" data-level="4.3.6" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#keep-relevant-information"><i class="fa fa-check"></i><b>4.3.6</b> 6. Keep relevant information</a></li>
<li class="chapter" data-level="4.3.7" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#choose-the-right-graph"><i class="fa fa-check"></i><b>4.3.7</b> 7. Choose the right graph</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#example"><i class="fa fa-check"></i><b>4.4</b> Example</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#setup-1"><i class="fa fa-check"></i><b>4.4.1</b> Setup</a></li>
<li class="chapter" data-level="4.4.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#inspect"><i class="fa fa-check"></i><b>4.4.2</b> Inspect</a></li>
<li class="chapter" data-level="4.4.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#absolute-value"><i class="fa fa-check"></i><b>4.4.3</b> Absolute Value</a></li>
<li class="chapter" data-level="4.4.4" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#missing-values"><i class="fa fa-check"></i><b>4.4.4</b> Missing values</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#measuring-selection"><i class="fa fa-check"></i><b>4.5</b> Measuring Selection</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#relative-fitness"><i class="fa fa-check"></i><b>4.5.1</b> Relative Fitness</a></li>
<li class="chapter" data-level="4.5.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#trait-value"><i class="fa fa-check"></i><b>4.5.2</b> Trait Value</a></li>
<li class="chapter" data-level="4.5.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#s-vs-beta"><i class="fa fa-check"></i><b>4.5.3</b> <span class="math inline">\(s\)</span> vs <span class="math inline">\(\beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#ggplot-vs-qplot"><i class="fa fa-check"></i><b>4.6</b> <code>ggplot</code> vs <code>qplot</code></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#histogram-2"><i class="fa fa-check"></i><b>4.6.1</b> Histogram</a></li>
<li class="chapter" data-level="4.6.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#aes"><i class="fa fa-check"></i><b>4.6.2</b> <code>aes</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#layers"><i class="fa fa-check"></i><b>4.6.3</b> Layers</a></li>
<li class="chapter" data-level="4.6.4" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#stat_name"><i class="fa fa-check"></i><b>4.6.4</b> <code>stat_NAME</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#bivariate-geom"><i class="fa fa-check"></i><b>4.6.5</b> Bivariate geom</a></li>
<li class="chapter" data-level="4.6.6" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#geom_smooth"><i class="fa fa-check"></i><b>4.6.6</b> <code>geom_smooth</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#full-ggplot"><i class="fa fa-check"></i><b>4.7</b> Full ggplot</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#separate-data"><i class="fa fa-check"></i><b>4.7.1</b> Separate data</a></li>
<li class="chapter" data-level="4.7.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#bootstrap"><i class="fa fa-check"></i><b>4.7.2</b> Bootstrap</a></li>
<li class="chapter" data-level="4.7.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#plot-data"><i class="fa fa-check"></i><b>4.7.3</b> Plot data</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#multi-graph"><i class="fa fa-check"></i><b>4.8</b> Multi-graph</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#facets-1"><i class="fa fa-check"></i><b>4.8.1</b> <code>facets</code></a></li>
<li class="chapter" data-level="4.8.2" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#grid.extra-package"><i class="fa fa-check"></i><b>4.8.2</b> <code>grid.extra</code> package</a></li>
<li class="chapter" data-level="4.8.3" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#grid-package"><i class="fa fa-check"></i><b>4.8.3</b> <code>grid</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="advanced-visualizations.html"><a href="advanced-visualizations.html#further-reading"><i class="fa fa-check"></i><b>4.9</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regular-expressions.html"><a href="regular-expressions.html"><i class="fa fa-check"></i><b>5</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="regular-expressions.html"><a href="regular-expressions.html#overview-2"><i class="fa fa-check"></i><b>5.1</b> Overview</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="regular-expressions.html"><a href="regular-expressions.html#universal"><i class="fa fa-check"></i><b>5.1.1</b> Universal</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="regular-expressions.html"><a href="regular-expressions.html#functions-1"><i class="fa fa-check"></i><b>5.2</b> Functions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="regular-expressions.html"><a href="regular-expressions.html#examples"><i class="fa fa-check"></i><b>5.2.1</b> Examples</a></li>
<li class="chapter" data-level="5.2.2" data-path="regular-expressions.html"><a href="regular-expressions.html#grep"><i class="fa fa-check"></i><b>5.2.2</b> <code>grep()</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="regular-expressions.html"><a href="regular-expressions.html#grepl"><i class="fa fa-check"></i><b>5.2.3</b> <code>grepl()</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="regular-expressions.html"><a href="regular-expressions.html#sub"><i class="fa fa-check"></i><b>5.2.4</b> <code>sub()</code></a></li>
<li class="chapter" data-level="5.2.5" data-path="regular-expressions.html"><a href="regular-expressions.html#gsub"><i class="fa fa-check"></i><b>5.2.5</b> <code>gsub()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regular-expressions.html"><a href="regular-expressions.html#wildcards"><i class="fa fa-check"></i><b>5.3</b> Wildcards</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="regular-expressions.html"><a href="regular-expressions.html#escape-character"><i class="fa fa-check"></i><b>5.3.1</b> <code>\</code> escape character</a></li>
<li class="chapter" data-level="5.3.2" data-path="regular-expressions.html"><a href="regular-expressions.html#in-r"><i class="fa fa-check"></i><b>5.3.2</b> <code>\\</code> in R</a></li>
<li class="chapter" data-level="5.3.3" data-path="regular-expressions.html"><a href="regular-expressions.html#w"><i class="fa fa-check"></i><b>5.3.3</b> <code>\\w</code></a></li>
<li class="chapter" data-level="5.3.4" data-path="regular-expressions.html"><a href="regular-expressions.html#w-1"><i class="fa fa-check"></i><b>5.3.4</b> <code>\\W</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="regular-expressions.html"><a href="regular-expressions.html#s"><i class="fa fa-check"></i><b>5.3.5</b> <code>\\s</code></a></li>
<li class="chapter" data-level="5.3.6" data-path="regular-expressions.html"><a href="regular-expressions.html#t"><i class="fa fa-check"></i><b>5.3.6</b> <code>\\t</code></a></li>
<li class="chapter" data-level="5.3.7" data-path="regular-expressions.html"><a href="regular-expressions.html#d"><i class="fa fa-check"></i><b>5.3.7</b> <code>\\d</code></a></li>
<li class="chapter" data-level="5.3.8" data-path="regular-expressions.html"><a href="regular-expressions.html#d-1"><i class="fa fa-check"></i><b>5.3.8</b> <code>\\D</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regular-expressions.html"><a href="regular-expressions.html#new-lines"><i class="fa fa-check"></i><b>5.4</b> New Lines</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="regular-expressions.html"><a href="regular-expressions.html#r"><i class="fa fa-check"></i><b>5.4.1</b> <code>\\r</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="regular-expressions.html"><a href="regular-expressions.html#n"><i class="fa fa-check"></i><b>5.4.2</b> <code>\\n</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="regular-expressions.html"><a href="regular-expressions.html#big-problem"><i class="fa fa-check"></i><b>5.4.3</b> Big Problem</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="regular-expressions.html"><a href="regular-expressions.html#special-characters"><i class="fa fa-check"></i><b>5.5</b> Special characters</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="regular-expressions.html"><a href="regular-expressions.html#section"><i class="fa fa-check"></i><b>5.5.1</b> <code>|</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="regular-expressions.html"><a href="regular-expressions.html#section-1"><i class="fa fa-check"></i><b>5.5.2</b> <code>.</code></a></li>
<li class="chapter" data-level="5.5.3" data-path="regular-expressions.html"><a href="regular-expressions.html#section-2"><i class="fa fa-check"></i><b>5.5.3</b> <code>*</code>, <code>?</code>, <code>+</code>, <code>{}</code></a></li>
<li class="chapter" data-level="5.5.4" data-path="regular-expressions.html"><a href="regular-expressions.html#section-4"><i class="fa fa-check"></i><b>5.5.4</b> <code>*</code></a></li>
<li class="chapter" data-level="5.5.5" data-path="regular-expressions.html"><a href="regular-expressions.html#section-5"><i class="fa fa-check"></i><b>5.5.5</b> <code>?</code></a></li>
<li class="chapter" data-level="5.5.6" data-path="regular-expressions.html"><a href="regular-expressions.html#section-6"><i class="fa fa-check"></i><b>5.5.6</b> <code>+?</code></a></li>
<li class="chapter" data-level="5.5.7" data-path="regular-expressions.html"><a href="regular-expressions.html#section-7"><i class="fa fa-check"></i><b>5.5.7</b> <code>*?</code></a></li>
<li class="chapter" data-level="5.5.8" data-path="regular-expressions.html"><a href="regular-expressions.html#section-8"><i class="fa fa-check"></i><b>5.5.8</b> <code>{}</code></a></li>
<li class="chapter" data-level="5.5.9" data-path="regular-expressions.html"><a href="regular-expressions.html#nm"><i class="fa fa-check"></i><b>5.5.9</b> <code>{n,m}</code></a></li>
<li class="chapter" data-level="5.5.10" data-path="regular-expressions.html"><a href="regular-expressions.html#n-1"><i class="fa fa-check"></i><b>5.5.10</b> <code>{n}</code></a></li>
<li class="chapter" data-level="5.5.11" data-path="regular-expressions.html"><a href="regular-expressions.html#n-2"><i class="fa fa-check"></i><b>5.5.11</b> <code>{n,}</code></a></li>
<li class="chapter" data-level="5.5.12" data-path="regular-expressions.html"><a href="regular-expressions.html#section-9"><i class="fa fa-check"></i><b>5.5.12</b> {}?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="regular-expressions.html"><a href="regular-expressions.html#section-10"><i class="fa fa-check"></i><b>5.6</b> <code>[]</code></a></li>
<li class="chapter" data-level="5.7" data-path="regular-expressions.html"><a href="regular-expressions.html#and"><i class="fa fa-check"></i><b>5.7</b> <code>^</code> and <code>$</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="regular-expressions.html"><a href="regular-expressions.html#section-11"><i class="fa fa-check"></i><b>5.7.1</b> <code>^</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="regular-expressions.html"><a href="regular-expressions.html#section-12"><i class="fa fa-check"></i><b>5.7.2</b> <code>$</code></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="regular-expressions.html"><a href="regular-expressions.html#section-13"><i class="fa fa-check"></i><b>5.8</b> <code>()</code></a></li>
<li class="chapter" data-level="5.9" data-path="regular-expressions.html"><a href="regular-expressions.html#scraping"><i class="fa fa-check"></i><b>5.9</b> Scraping</a></li>
<li class="chapter" data-level="5.10" data-path="regular-expressions.html"><a href="regular-expressions.html#examples-1"><i class="fa fa-check"></i><b>5.10</b> Examples</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="regular-expressions.html"><a href="regular-expressions.html#transect-data"><i class="fa fa-check"></i><b>5.10.1</b> Transect Data</a></li>
<li class="chapter" data-level="5.10.2" data-path="regular-expressions.html"><a href="regular-expressions.html#genbank"><i class="fa fa-check"></i><b>5.10.2</b> Genbank</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="regular-expressions.html"><a href="regular-expressions.html#solutions"><i class="fa fa-check"></i><b>5.11</b> Solutions</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="regular-expressions.html"><a href="regular-expressions.html#transects"><i class="fa fa-check"></i><b>5.11.1</b> Transects</a></li>
<li class="chapter" data-level="5.11.2" data-path="regular-expressions.html"><a href="regular-expressions.html#genbank-1"><i class="fa fa-check"></i><b>5.11.2</b> Genbank</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="regular-expressions.html"><a href="regular-expressions.html#more-exercises"><i class="fa fa-check"></i><b>5.12</b> More Exercises</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="regular-expressions.html"><a href="regular-expressions.html#consider-a-vector-of-email-addresses-scraped-from-the-internet"><i class="fa fa-check"></i><b>5.12.1</b> 1. Consider a vector of email addresses scraped from the internet:</a></li>
<li class="chapter" data-level="5.12.2" data-path="regular-expressions.html"><a href="regular-expressions.html#create-a-random-sequence-of-dna"><i class="fa fa-check"></i><b>5.12.2</b> 2. Create a random sequence of DNA:</a></li>
<li class="chapter" data-level="5.12.3" data-path="regular-expressions.html"><a href="regular-expressions.html#more-online-examples"><i class="fa fa-check"></i><b>5.12.3</b> 3. More online examples</a></li>
<li class="chapter" data-level="5.12.4" data-path="regular-expressions.html"><a href="regular-expressions.html#regex-golf"><i class="fa fa-check"></i><b>5.12.4</b> 4. Regex Golf</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-science-intro.html"><a href="data-science-intro.html"><i class="fa fa-check"></i><b>6</b> Data Science Intro</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-science-intro.html"><a href="data-science-intro.html#setup-2"><i class="fa fa-check"></i><b>6.1</b> Setup</a></li>
<li class="chapter" data-level="6.2" data-path="data-science-intro.html"><a href="data-science-intro.html#introduction-to-data-science"><i class="fa fa-check"></i><b>6.2</b> Introduction to Data Science</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-science-intro.html"><a href="data-science-intro.html#data-science-life-cycle"><i class="fa fa-check"></i><b>6.2.1</b> Data Science Life-Cycle</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-science-intro.html"><a href="data-science-intro.html#data-science-in-r"><i class="fa fa-check"></i><b>6.2.2</b> Data Science in R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-science-intro.html"><a href="data-science-intro.html#d-data-wrangling"><i class="fa fa-check"></i><b>6.3</b> 2D Data Wrangling</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-science-intro.html"><a href="data-science-intro.html#filter"><i class="fa fa-check"></i><b>6.3.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="data-science-intro.html"><a href="data-science-intro.html#rename"><i class="fa fa-check"></i><b>6.3.2</b> <code>rename()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="data-science-intro.html"><a href="data-science-intro.html#arrange"><i class="fa fa-check"></i><b>6.3.3</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="data-science-intro.html"><a href="data-science-intro.html#select"><i class="fa fa-check"></i><b>6.3.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="data-science-intro.html"><a href="data-science-intro.html#everything"><i class="fa fa-check"></i><b>6.3.5</b> <code>everything()</code></a></li>
<li class="chapter" data-level="6.3.6" data-path="data-science-intro.html"><a href="data-science-intro.html#mutate"><i class="fa fa-check"></i><b>6.3.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="6.3.7" data-path="data-science-intro.html"><a href="data-science-intro.html#transmute"><i class="fa fa-check"></i><b>6.3.7</b> <code>transmute()</code></a></li>
<li class="chapter" data-level="6.3.8" data-path="data-science-intro.html"><a href="data-science-intro.html#summarize-group_by"><i class="fa fa-check"></i><b>6.3.8</b> <code>summarize()</code> + <code>group_by()</code></a></li>
<li class="chapter" data-level="6.3.9" data-path="data-science-intro.html"><a href="data-science-intro.html#weighted-mean"><i class="fa fa-check"></i><b>6.3.9</b> Weighted Mean</a></li>
<li class="chapter" data-level="6.3.10" data-path="data-science-intro.html"><a href="data-science-intro.html#pipe"><i class="fa fa-check"></i><b>6.3.10</b> <code>%&gt;%</code> (pipe)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-science-intro.html"><a href="data-science-intro.html#missing-data"><i class="fa fa-check"></i><b>6.4</b> Missing Data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-science-intro.html"><a href="data-science-intro.html#na-and-na.rm"><i class="fa fa-check"></i><b>6.4.1</b> <code>NA</code> and <code>na.rm()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="data-science-intro.html"><a href="data-science-intro.html#na-vs-0"><i class="fa fa-check"></i><b>6.4.2</b> <code>NA</code> vs <code>0</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="data-science-intro.html"><a href="data-science-intro.html#is.na"><i class="fa fa-check"></i><b>6.4.3</b> <code>is.na()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-science-intro.html"><a href="data-science-intro.html#naughty-data"><i class="fa fa-check"></i><b>6.5</b> Naughty Data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-r.html"><a href="advanced-r.html"><i class="fa fa-check"></i><b>7</b> Advanced R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-r.html"><a href="advanced-r.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-r.html"><a href="advanced-r.html#getting-started-2"><i class="fa fa-check"></i><b>7.2</b> Getting Started</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-r.html"><a href="advanced-r.html#r-markdown"><i class="fa fa-check"></i><b>7.3</b> R Markdown</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="advanced-r.html"><a href="advanced-r.html#cheat-sheet"><i class="fa fa-check"></i><b>7.3.1</b> Cheat Sheet</a></li>
<li class="chapter" data-level="7.3.2" data-path="advanced-r.html"><a href="advanced-r.html#create"><i class="fa fa-check"></i><b>7.3.2</b> Create</a></li>
<li class="chapter" data-level="7.3.3" data-path="advanced-r.html"><a href="advanced-r.html#yaml-header"><i class="fa fa-check"></i><b>7.3.3</b> YAML Header</a></li>
<li class="chapter" data-level="7.3.4" data-path="advanced-r.html"><a href="advanced-r.html#markdown"><i class="fa fa-check"></i><b>7.3.4</b> Markdown</a></li>
<li class="chapter" data-level="7.3.5" data-path="advanced-r.html"><a href="advanced-r.html#basic-elements"><i class="fa fa-check"></i><b>7.3.5</b> Basic elements:</a></li>
<li class="chapter" data-level="7.3.6" data-path="advanced-r.html"><a href="advanced-r.html#headers"><i class="fa fa-check"></i><b>7.3.6</b> Headers</a></li>
<li class="chapter" data-level="7.3.7" data-path="advanced-r.html"><a href="advanced-r.html#other-elements"><i class="fa fa-check"></i><b>7.3.7</b> Other Elements</a></li>
<li class="chapter" data-level="7.3.8" data-path="advanced-r.html"><a href="advanced-r.html#links"><i class="fa fa-check"></i><b>7.3.8</b> Links</a></li>
<li class="chapter" data-level="7.3.9" data-path="advanced-r.html"><a href="advanced-r.html#images"><i class="fa fa-check"></i><b>7.3.9</b> Images</a></li>
<li class="chapter" data-level="7.3.10" data-path="advanced-r.html"><a href="advanced-r.html#lists-and-tables"><i class="fa fa-check"></i><b>7.3.10</b> Lists and tables</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="advanced-r.html"><a href="advanced-r.html#tables"><i class="fa fa-check"></i><b>7.4</b> Tables</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advanced-r.html"><a href="advanced-r.html#embed-r-code"><i class="fa fa-check"></i><b>7.4.1</b> Embed R Code</a></li>
<li class="chapter" data-level="7.4.2" data-path="advanced-r.html"><a href="advanced-r.html#dynamic-tables"><i class="fa fa-check"></i><b>7.4.2</b> Dynamic tables</a></li>
<li class="chapter" data-level="7.4.3" data-path="advanced-r.html"><a href="advanced-r.html#embed-graphs"><i class="fa fa-check"></i><b>7.4.3</b> Embed Graphs</a></li>
<li class="chapter" data-level="7.4.4" data-path="advanced-r.html"><a href="advanced-r.html#options-for-header"><i class="fa fa-check"></i><b>7.4.4</b> Options for header</a></li>
<li class="chapter" data-level="7.4.5" data-path="advanced-r.html"><a href="advanced-r.html#content-as-tabs"><i class="fa fa-check"></i><b>7.4.5</b> Content as tabs</a></li>
<li class="chapter" data-level="7.4.6" data-path="advanced-r.html"><a href="advanced-r.html#quarterly-results"><i class="fa fa-check"></i><b>7.4.6</b> Quarterly Results</a></li>
<li class="chapter" data-level="7.4.7" data-path="advanced-r.html"><a href="advanced-r.html#equations"><i class="fa fa-check"></i><b>7.4.7</b> Equations</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advanced-r.html"><a href="advanced-r.html#custom-functions"><i class="fa fa-check"></i><b>7.5</b> Custom Functions</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="advanced-r.html"><a href="advanced-r.html#general-form"><i class="fa fa-check"></i><b>7.5.1</b> General form:</a></li>
<li class="chapter" data-level="7.5.2" data-path="advanced-r.html"><a href="advanced-r.html#example-function"><i class="fa fa-check"></i><b>7.5.2</b> Example function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="advanced-r.html"><a href="advanced-r.html#custom-r-package"><i class="fa fa-check"></i><b>7.6</b> Custom R Package</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="advanced-r.html"><a href="advanced-r.html#introduction-2"><i class="fa fa-check"></i><b>7.6.1</b> Introduction</a></li>
<li class="chapter" data-level="7.6.2" data-path="advanced-r.html"><a href="advanced-r.html#getting-started-3"><i class="fa fa-check"></i><b>7.6.2</b> Getting started</a></li>
<li class="chapter" data-level="7.6.3" data-path="advanced-r.html"><a href="advanced-r.html#add-functions"><i class="fa fa-check"></i><b>7.6.3</b> Add functions</a></li>
<li class="chapter" data-level="7.6.4" data-path="advanced-r.html"><a href="advanced-r.html#adding-documentation"><i class="fa fa-check"></i><b>7.6.4</b> Adding documentation</a></li>
<li class="chapter" data-level="7.6.5" data-path="advanced-r.html"><a href="advanced-r.html#add-a-manual"><i class="fa fa-check"></i><b>7.6.5</b> Add a Manual</a></li>
<li class="chapter" data-level="7.6.6" data-path="advanced-r.html"><a href="advanced-r.html#installing-the-package"><i class="fa fa-check"></i><b>7.6.6</b> Installing the package</a></li>
<li class="chapter" data-level="7.6.7" data-path="advanced-r.html"><a href="advanced-r.html#input-checking"><i class="fa fa-check"></i><b>7.6.7</b> Input checking</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="advanced-r.html"><a href="advanced-r.html#make-it-public"><i class="fa fa-check"></i><b>7.7</b> Make it public</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="advanced-r.html"><a href="advanced-r.html#references"><i class="fa fa-check"></i><b>7.7.1</b> References:</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Crash Course</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-visualizations" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Advanced Visualizations</h1>
<div id="overview-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Overview</h2>
<p>Before following this tutorial, you should be familiar with the <a href="https://colauttilab.github.io/RCrashCourse/2_qplot.html">qplot() tutorial</a>, and you should have lots of practice making graphs with different formatting options using <code>qplot</code>.</p>
<p>In this self-tutorial, we look at some more advanced options for visualizations by using the <code>ggplot</code> function. The 1<code>ggplot</code> function adds even more flexibiliity and possibilities to our visualizations.</p>
<p>The <a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">ggplot cheat sheet</a> is a downloadable pdf that provides a good summary and quick-reference guide for advanced graphics.</p>
</div>
<div id="getting-started-1" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Getting Started</h2>
<p>We’ll load the ggplot2 library and set a custom theme as described in the <a href="https://colauttilab.github.io/RCrashCourse/2_qplot.html">qplot Tutorial</a></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="advanced-visualizations.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb350-2"><a href="advanced-visualizations.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;http://bit.ly/theme_pub&quot;</span>)</span>
<span id="cb350-3"><a href="advanced-visualizations.html#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_pub</span>())</span></code></pre></div>
<p>The <code>source</code> function loads an external file, in this case from the internet. The file is just a .R file with a custom function defining different aspects of the graph (e.g. text size, line width, etc.) You can open the link in a web browser or download and open in a text editor to see the file.</p>
<p>The <code>theme_set()</code> command sets our custom theme (<code>theme_pub</code>) as the default plotting theme. Since the theme is a function in R, we need the extra brackets: <code>theme_pub()</code></p>
<p><br></p>
<hr />
<p><br></p>
</div>
<div id="rules-of-thumb" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Rules of thumb</h2>
<p>Standards of practice for published graphs in professional journals can vary depending on format and discipline, but there are a number of useful ‘rules of thumb’ to keep in mind. These are not hard and fast rules but helpful for new researchers who aren’t sure how or where to start.</p>
<div id="minimize-ink" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> 1. Minimize ‘ink’</h3>
<p>In the old days, when most papers were actually printed and mailed to journal subscribers, black ink was expensive and printing in colour was very expensive. Printing is still expensive but of course most research articles are available online where there is no additional cost to colour or extra ink. However, the concept of minimizing ink (or pixels) can go a long way toward keeping a graph free from clutter and unnecessary distraction.</p>
</div>
<div id="use-space-wisely" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> 2. Use space wisely</h3>
<p>Empty space is not necessarily bad, but ask yourself if it is necessary and what you want the reader to take away. Consider the next two graphs:</p>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<blockquote>
<p>Above: Y-axis scaled to the data</p>
</blockquote>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<blockquote>
<p>Above: Y-axis scaled between 0 and 100</p>
</blockquote>
<p>What are the benefits/drawbacks of scaling the axes? When might you choose to use one over ther other?</p>
</div>
<div id="choose-a-colour-palette" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> 3. Choose a colour palette</h3>
<p>Colour has three basic components</p>
<ol style="list-style-type: lower-alpha">
<li>Hue – the amount of red vs green vs blue light</li>
<li>Saturation – how vivid the colour is</li>
<li>Brightness – the amount of white (vs black) in the colour</li>
</ol>
<p>In R these can be easily defined with the <code>rgb()</code> function. For example:</p>
<p><code>rgb(1,0,0)</code> – a saturated red
<code>rgb(0.1,0,0)</code> – a dark red (low brightness, low saturation)
<code>rgb(1,0.9,0.9)</code> – a light red (high brightness, low saturation)</p>
<p>Don’t underestimate the impact of choosing a good colour palette, especially for presentations. Colour theory can get a bit overwhelming but here are a few good websites to help:</p>
<ul>
<li>Quickly generate your own palette using <a href="https://coolors.co">coolors</a></li>
<li>Use a colour wheel to find complementary colours using <a href="https://color.adobe.com/create">Adobe</a></li>
<li>Browse some pre-made palettes or create one from a picture <a href="http://www.colorfavs.com">colorfavs</a></li>
</ul>
</div>
<div id="colours-have-meaning" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> 4. Colours have meaning</h3>
<p>What’s wrong with this graph?</p>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Humans naturally associate colours with particular feelings. Be mindful of these associations when choosing a colour palette</p>
<p>Another important consideration is that not everyone sees colour the same way. About 5% to 10% of the population has colour blindness. In order to make colour graphs readable to everyone, you can use different</p>
</div>
<div id="maximize-contrast" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> 5. Maximize contrast</h3>
<p>Colours that are too similar will be hard to distinguish</p>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="keep-relevant-information" class="section level3" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> 6. Keep relevant information</h3>
<p>Make sure to include proper axis <strong>labels</strong> (i.e. names) and <strong>tick marks</strong> (i.e. numbers or categories showing the different values). These labels, along with the figure caption, should act as a stand-alone unit. The reader should be able to understand the figure without having to read through the rest of the paper.</p>
</div>
<div id="choose-the-right-graph" class="section level3" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> 7. Choose the right graph</h3>
<p>Often the same data can be presented in different ways but some are easier to interpret than others. Think carefully about the story you want to present and the main ideas you want your reader to get from your figures. Look at these two graphs that show the same data and see which one is more intuitive</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="advanced-visualizations.html#cb351-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb351-2"><a href="advanced-visualizations.html#cb351-2" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span>X<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb351-3"><a href="advanced-visualizations.html#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="fu">c</span>(X,Y),<span class="at">fill=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;X&quot;</span>,<span class="dv">100</span>),<span class="fu">rep</span>(<span class="st">&quot;Y&quot;</span>,<span class="dv">100</span>)),<span class="at">posit=</span><span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="advanced-visualizations.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(X,Y)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
<div id="example" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Example</h2>
<p>To get to know ggplot better, let’s do a step-by-step example of a figure published in a <a href="https://doi.org/10.1111/mec.13162">paper by Colautti &amp; Lau</a> in the journal Molecular Ecology (2015)</p>
<div id="setup-1" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Setup</h3>
<div id="import-data" class="section level4" number="4.4.1.1">
<h4><span class="header-section-number">4.4.1.1</span> Import data</h4>
<p>Download selection dataset from Colautti &amp; Lau (2015), published in the journal <strong>Molecular Ecology</strong>: <a href="https://doi.org/10.1111/mec.13162" class="uri">https://doi.org/10.1111/mec.13162</a></p>
<p>The paper is a meta-analysis and review of evolution occurring during biological invasions. in this tutorial, we’ll recreate Figure 2, which shows the result of a meta-analysis of selection gradients (<span class="math inline">\(\beta\)</span>) and selection differentials (<span class="math inline">\(\s\)</span>). First, we’ll just recreate the top panel, and then we’ll look at ways to make more advanced multi-panel graphs like this one.</p>
<p>The data from the paper are archived on Dryad: <a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.gt678" class="uri">https://datadryad.org/stash/dataset/doi:10.5061/dryad.gt678</a></p>
<p>You could downoad the zip file and look for the file called <code>Selection_Data.csv</code> and save it to your working directory.</p>
<p>Or you can just download directly from this website:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="advanced-visualizations.html#cb354-1" aria-hidden="true" tabindex="-1"></a>SelData<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;https://colauttilab.github.io/RCrashCourse/Selection_Data.csv&quot;</span>,</span>
<span id="cb354-2"><a href="advanced-visualizations.html#cb354-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">header=</span>T)</span></code></pre></div>
<p>We are also going to change the names from the file to make them a bit more intuitive and easier to work with in R.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="advanced-visualizations.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(SelData)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Collector&quot;</span>, <span class="st">&quot;Author&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Journal&quot;</span>, <span class="st">&quot;Vol&quot;</span>, </span>
<span id="cb355-2"><a href="advanced-visualizations.html#cb355-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Native&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;Fitness.measure&quot;</span>, <span class="st">&quot;Trait&quot;</span>, <span class="st">&quot;s&quot;</span>, </span>
<span id="cb355-3"><a href="advanced-visualizations.html#cb355-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;s.SE&quot;</span>, <span class="st">&quot;s.P&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B.SE&quot;</span>, <span class="st">&quot;B.P&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="inspect" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Inspect</h3>
<p>Let’s take a quick look at the data</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="advanced-visualizations.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SelData)</span></code></pre></div>
<pre><code>##           Collector               Author Year             Journal
## 1 KingsolverDiamond Alatalo and Lundberg 1986           Evolution
## 2 KingsolverDiamond Alatalo and Lundberg 1986           Evolution
## 3 KingsolverDiamond Alatalo and Lundberg 1986           Evolution
## 4 KingsolverDiamond       Alatalo et al. 1990 American Naturalist
## 5 KingsolverDiamond       Alatalo et al. 1990 American Naturalist
## 6 KingsolverDiamond       Alatalo et al. 1990 American Naturalist
##              Vol             Species Native    N       Fitness.measure
## 1     40:574-583  Ficedula hypoleuca    yes  641   male mating success
## 2     40:574-583  Ficedula hypoleuca    yes  713 female mating success
## 3     40:574-583  Ficedula hypoleuca    yes 1705              survival
## 4 135(3):464-471 Ficedula albicollis    yes &lt;NA&gt;              survival
## 5 135(3):464-471 Ficedula albicollis    yes &lt;NA&gt;              survival
## 6 135(3):464-471 Ficedula albicollis    yes &lt;NA&gt;              survival
##           Trait     s s.SE s.P     B B.SE B.P
## 1 tarsus length -0.01       ns    NA         
## 2 tarsus length  0.01      sig    NA         
## 3 tarsus length  0.04       ns    NA         
## 4  tarus length  0.02       ns -0.06         
## 5  tarus length  0.08       ns -0.01         
## 6  tarus length  0.19      sig  0.01</code></pre>
<p>It’s worth taking some time to look at this to understand how a meta-analysis works. The <strong>collector</strong> column indicates the paper that the data came from. The <strong>Author</strong> indicates the author(s) of the original paper that reported the data. The <strong>Year</strong>, <strong>Journal</strong>, and <strong>Vol</strong> give information about the publication that the data came from originally.</p>
<p>We can see above the collector <code>KingsolverDiamond</code>, which represents a paper from Kingsolver and Diamond that was itself a meta-analysis of natural selection. Most of the studies came from this meta-analysis, but a few of the more recent papers were added by grad students, denoted by initials:</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="advanced-visualizations.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(SelData<span class="sc">$</span>Collector)</span></code></pre></div>
<pre><code>## [1] &quot;KingsolverDiamond&quot; &quot;JAL&quot;               &quot;DJW&quot;              
## [4] &quot;CPT&quot;</code></pre>
<p><strong>Species</strong> is the study species, and <strong>Native</strong> is its stauts as a binary yes/no variable. <strong>N</strong> is the sample size and <strong>Fitness.measure</strong> is the specific trait that defines fitness. <strong>Trait</strong> is the trait on which selection was measured. Finally, <span class="math inline">\(s\)</span> is the <strong>selection differential</strong> and <span class="math inline">\(\beta\)</span> is the <strong>selection gradient</strong>. Note that these are slopes in units of relative fitness per trait standard deviation. This is explained in more detail below.</p>
</div>
<div id="absolute-value" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Absolute Value</h3>
<p>In this analysis, we are interested in the magnitude but not the direction of natural selection. In other words we would want to treat a slope of -4 the same as a slope of +4 because they have the same magnitude. Therefore, we can replace the <span class="math inline">\(s\)</span> column with <span class="math inline">\(|s|\)</span></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="advanced-visualizations.html#cb360-1" aria-hidden="true" tabindex="-1"></a>SelData<span class="sc">$</span>s<span class="ot">&lt;-</span><span class="fu">abs</span>(SelData<span class="sc">$</span>s)</span></code></pre></div>
<p>We’ll also add a couple of columns with random variables that we can use later to explore additional plotting options.</p>
<p>First, a column of values sampled from a z-distribution (Gaussian distribution with mean = 0 and sd = 1)</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="advanced-visualizations.html#cb361-1" aria-hidden="true" tabindex="-1"></a>SelData<span class="sc">$</span>Rpoint<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="fu">nrow</span>(SelData)) <span class="co"># Random, normally distributed</span></span></code></pre></div>
<p>Second, a columnn of 1 and 0 sampled randomly with equal frequency (p = 0.5)</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="advanced-visualizations.html#cb362-1" aria-hidden="true" tabindex="-1"></a>SelData<span class="sc">$</span>Rgroup<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">nrow</span>(SelData),<span class="at">replace=</span>T) <span class="co"># Random binary value</span></span></code></pre></div>
</div>
<div id="missing-values" class="section level3" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Missing values</h3>
<p>Note the missing data (denoted NA)</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="advanced-visualizations.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(SelData<span class="sc">$</span>s)</span></code></pre></div>
<p>We can subset to remove mising data</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="advanced-visualizations.html#cb364-1" aria-hidden="true" tabindex="-1"></a>SelData<span class="ot">&lt;-</span>SelData[<span class="sc">!</span><span class="fu">is.na</span>(SelData<span class="sc">$</span>s),]</span></code></pre></div>
<p>Recall from the <a href="https://colauttilab.github.io/RCrashCourse/1_fundamentals.html">R Fundamentals Tutorial</a> that <code>!</code> means ‘not’ or ‘invert’</p>
<p>Alternatively, we could use <code>filter</code> from dplyr</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="advanced-visualizations.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb365-2"><a href="advanced-visualizations.html#cb365-2" aria-hidden="true" tabindex="-1"></a>SelData<span class="ot">&lt;-</span>SelData <span class="sc">%&gt;%</span></span>
<span id="cb365-3"><a href="advanced-visualizations.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(s))</span></code></pre></div>
<p>There is also has a convenient <code>drop_na</code> function in the <code>tidyr</code> package</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="advanced-visualizations.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb366-2"><a href="advanced-visualizations.html#cb366-2" aria-hidden="true" tabindex="-1"></a>SelData<span class="ot">&lt;-</span>SelData <span class="sc">%&gt;%</span></span>
<span id="cb366-3"><a href="advanced-visualizations.html#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(s)</span></code></pre></div>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
<div id="measuring-selection" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Measuring Selection</h2>
<p>A simple analysis of phenotypic selection as proposed by Lande &amp; Arnold (1983) is just a linear model with <strong>relative fitness</strong> on the y-axis and the <strong>standardized trait value</strong> on the x-axis.</p>
<div id="relative-fitness" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Relative Fitness</h3>
<p><strong>Fitness</strong> can be measured in many ways, such as survival or lifetime seed or egg production. Use <code>unique(SelData$Fitness.measure)</code> to see the list of specific fitness measures used in these studies.</p>
<p><strong>relative fitness</strong> is just the observed or <strong>absolute fitness</strong> divided by the mean. <strong>Absolute fitness</strong> is usually denoted by the capital letter <span class="math inline">\(W\)</span> and <strong>relative fitness</strong> is usually represented by a lower-case <span class="math inline">\(w\)</span> or omega <span class="math inline">\(\omega\)</span>. Expressing this in mathematical terms:</p>
<p><span class="math display">\[ \omega = W_i/\bar W \]</span></p>
</div>
<div id="trait-value" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Trait Value</h3>
<p>A <strong>Trait Value</strong> is literally just the measured trait. Use <code>unique(SelData$Trait)</code> to see the list of specific traits that were measured in these studies. The <strong>Standardized Trait Value</strong> is the traits z-score. See the <a href="https://colauttilab.github.io/RIntroStats/1_Distributions.html">Distributions Tutorial</a> for more information about z-scores. Since traits have different metrics, they are hard to compare: e.g. days to flower, egg biomass, foraging intensity, aggression. But standardizing traits to z-scores puts them all on the same scale for comparison. Specifically, the scale is in standard deviations from the mean.</p>
</div>
<div id="s-vs-beta" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> <span class="math inline">\(s\)</span> vs <span class="math inline">\(\beta\)</span></h3>
<p>Selection differentials (<span class="math inline">\(s\)</span>) and selection gradients (<span class="math inline">\(\beta\)</span>) measure selection using linear models but represent slightly different measurements. Linear models are covered in the <a href="https://colauttilab.github.io/RIntroStats/3_LinearModels.html">Linear Models Tutorial</a>.</p>
<p>Both models use relative fitness (<span class="math inline">\(\omega\)</span>) as the response variable (Y).</p>
<p>Selection differentials (<span class="math inline">\(s\)</span>) measure selection on only a single trait, ignoring all other traits. In theory, the response to selection is a simple function of the genetic correlation between a trait and fitness. Some of this theory, with examples in R, is covered in the <a href="https://colauttilab.github.io/PopGen/3_PopGenFUN_II.html#Natural_Selection">Population Genetics Tutorials</a>.</p>
<p>Fitness differences among individuals can depend on a lot of things – genetic variation for the trait itself, but also environmental effects on the trait as well as effects on other traits that are under selection and correlated with the trait of interest.</p>
<p>Selection gradients (<span class="math inline">\(\beta\)</span>) measure selection on a trait of interest while also accounting for selection on other correlated traits. This is done via a <strong>multiple regression</strong> – a linear model with multiple predictors.</p>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
<div id="ggplot-vs-qplot" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> <code>ggplot</code> vs <code>qplot</code></h2>
<p>We can create the same graph using qplot and ggplot, just the syntax changes.</p>
<div id="histogram-2" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Histogram</h3>
<p>Compare this <code>qplot</code></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="advanced-visualizations.html#cb367-1" aria-hidden="true" tabindex="-1"></a>BarPlot<span class="ot">&lt;-</span><span class="fu">qplot</span>(s, <span class="at">data=</span>SelData, <span class="at">fill=</span>Native, <span class="at">geom=</span><span class="st">&quot;bar&quot;</span>)</span>
<span id="cb367-2"><a href="advanced-visualizations.html#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BarPlot)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>with this <code>ggplot</code></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="advanced-visualizations.html#cb368-1" aria-hidden="true" tabindex="-1"></a>BarPlot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(s, <span class="at">fill=</span>Native), <span class="at">data=</span>SelData) </span></code></pre></div>
</div>
<div id="aes" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> <code>aes</code></h3>
<p>Note the use of the aesthetic funciton <code>aes()</code>. This defines the data that we want to use for our <code>ggplot</code> graph. We will see how we do this by adding layers to our plot, similar to the way old-timey cartoons were made by layering multiple clear pages of cellphane with painting on them. The <code>aes</code> function inside of the <code>ggplot</code> function defines that data that will be shared among all of the layers. In addition, we can have separate <code>aes</code> functions inside different <code>geom_</code> layers that define and restrict the plotting data to that specific layer.</p>
<p>Let’s look at the <code>ggplot</code> object so far:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="advanced-visualizations.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BarPlot)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>No data! This is one key difference between <code>qplot</code> and <code>ggplot</code>. The former has default <code>geoms</code> that it applies depending on the type of input data. We can modify geoms with the <code>geom='NAME'</code> parameter in <code>qplot</code>, where ‘NAME’ is the specific name of the geom we want to use.</p>
<p>In <code>ggplot</code> we have to explictly define the geoms using <code>geom_NAME</code> where name is the specific name of the geom – the same text that would go in quotation marks for the geom in <code>qplot</code>. The advantage of using <code>ggplot</code> is that its easier to creat multiple, overlapping layers with different geoms from types data sources.</p>
</div>
<div id="layers" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Layers</h3>
<p>So far, we have only loaded in the data info for plotting. We have to specify which geom(s) we want</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="advanced-visualizations.html#cb370-1" aria-hidden="true" tabindex="-1"></a>BarPlot<span class="ot">&lt;-</span> BarPlot <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="co"># info from ggplot() passed to geom_bar()</span></span>
<span id="cb370-2"><a href="advanced-visualizations.html#cb370-2" aria-hidden="true" tabindex="-1"></a>BarPlot</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Explore the components of our BarPlot object:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="advanced-visualizations.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BarPlot)</span></code></pre></div>
<pre><code>## data: Collector, Author, Year, Journal, Vol, Species, Native, N,
##   Fitness.measure, Trait, s, s.SE, s.P, B, B.SE, B.P, Rpoint, Rgroup
##   [2766x18]
## mapping:  x = ~s, fill = ~Native
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;
## -----------------------------------
## geom_bar: width = NULL, na.rm = FALSE, orientation = NA
## stat_count: width = NULL, na.rm = FALSE, orientation = NA
## position_stack</code></pre>
<p>This shows us the columns of data available, the mapping for our x and y axes, and our fill colours. It also shows some of the functions and parameters used to generate the graph. At the bottom we see parameters for <code>geom_bar</code> and <code>stat_count</code>. Note that there are more parameters than the ones we defined. These are the <strong>default parameters</strong>.</p>
</div>
<div id="stat_name" class="section level3" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> <code>stat_NAME</code></h3>
<p>If geoms are the geometry of the shapes in the plt, stats are the statistics or mathematical functions that create the geoms. In the above case, the bars in <code>geom_bar</code> are created by counting the number of observations in each bin. The <code>stat_count</code> function is responsible for this calculation, and it is called by default when we use the <code>geom_bar</code> function.</p>
<p>Just as we can change the geometry of the plotted shapes with <code>geom_NAME</code>, we can define different functions for generating shapes with <code>stat_NAME</code>. Luckily, there is a default stat for each geom, so we don’t have to choose it unless we want something other than the default.</p>
<p>For more information on the parameters and stast of <code>geom_bar()</code></p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="advanced-visualizations.html#cb373-1" aria-hidden="true" tabindex="-1"></a>?geom_bar</span></code></pre></div>
</div>
<div id="bivariate-geom" class="section level3" number="4.6.5">
<h3><span class="header-section-number">4.6.5</span> Bivariate geom</h3>
<p>Let’s explroe a few more plotting options. Here we’ll use the random normal values we generated above so that we can make a bivariate plot:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="advanced-visualizations.html#cb374-1" aria-hidden="true" tabindex="-1"></a>BivPlot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>SelData, <span class="fu">aes</span>(<span class="at">x=</span>s, <span class="at">y=</span>Rpoint)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb374-2"><a href="advanced-visualizations.html#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BivPlot)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Notice how the points are all clustered to the left. This looks like a classic log-normal variable, so let’s log-transform <span class="math inline">\(s\)</span> (x-axis)</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="advanced-visualizations.html#cb375-1" aria-hidden="true" tabindex="-1"></a>BivPlot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>SelData, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(s<span class="sc">+</span><span class="dv">1</span>), <span class="at">y=</span>Rpoint)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb375-2"><a href="advanced-visualizations.html#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BivPlot)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="geom_smooth" class="section level3" number="4.6.6">
<h3><span class="header-section-number">4.6.6</span> <code>geom_smooth</code></h3>
<p>A really handy feature of <code>ggplot</code> is the <code>geom_smooth</code> function with several options for calculating and plotting a statistical model to the observations.</p>
<p>Here’s a simple linear regression slope:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="advanced-visualizations.html#cb376-1" aria-hidden="true" tabindex="-1"></a>BivPlot <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">colour=</span><span class="st">&quot;steelblue&quot;</span>,<span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>We can use a grouping variable to add separate regression lines for each group</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="advanced-visualizations.html#cb378-1" aria-hidden="true" tabindex="-1"></a>BivPlot <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="fu">aes</span>(<span class="at">group=</span>Native,<span class="at">colour=</span>Native))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
<div id="full-ggplot" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Full ggplot</h2>
<p>Now that we’ve done a bit of exploration, let’s try to recreate the selection histograms from Colautti &amp; Lau:</p>
<ol style="list-style-type: decimal">
<li>Create separate data for native vs. introduced species</li>
<li>Use a bootstrap to estimate non-parametric mean and 95% confidence intervals</li>
<li>Plot all of the components on a single graph</li>
</ol>
<div id="separate-data" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Separate data</h3>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="advanced-visualizations.html#cb380-1" aria-hidden="true" tabindex="-1"></a>NatSVals<span class="ot">&lt;-</span>SelData<span class="sc">$</span>s[SelData<span class="sc">$</span>Native<span class="sc">==</span><span class="st">&quot;yes&quot;</span>] <span class="co"># s values for Native species</span></span>
<span id="cb380-2"><a href="advanced-visualizations.html#cb380-2" aria-hidden="true" tabindex="-1"></a>IntSVals<span class="ot">&lt;-</span>SelData<span class="sc">$</span>s[SelData<span class="sc">$</span>Native<span class="sc">==</span><span class="st">&quot;no&quot;</span>] <span class="co"># s values for Introduced species</span></span></code></pre></div>
</div>
<div id="bootstrap" class="section level3" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Bootstrap</h3>
<p>The graph includes a bootstrap model to estimate the mean and variance for each group (native=yes vs no). Bootstrapping is covered in the <a href="https://colauttilab.github.io/EcologyTutorials/bootstrap.html">Bootstrapping and Randomization Tutorial</a>. The example below is not the most efficient approach but it applies the flow control concepts covered in the <a href="https://colauttilab.github.io/RCrashCourse/1_fundamentals.html">R Fundamentals Tutorial</a></p>
<div id="data-setup-1" class="section level4" number="4.7.2.1">
<h4><span class="header-section-number">4.7.2.1</span> Data Setup</h4>
<p>First we define the number of iterations and set up two objects to hold the data from our bootstrap loops.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="advanced-visualizations.html#cb381-1" aria-hidden="true" tabindex="-1"></a>IterN<span class="ot">&lt;-</span><span class="dv">100</span> <span class="co"># Number of iterations</span></span>
<span id="cb381-2"><a href="advanced-visualizations.html#cb381-2" aria-hidden="true" tabindex="-1"></a>NatSims<span class="ot">&lt;-</span>{} <span class="co"># Dummy objects to hold output</span></span>
<span id="cb381-3"><a href="advanced-visualizations.html#cb381-3" aria-hidden="true" tabindex="-1"></a>IntSims<span class="ot">&lt;-</span>{}</span></code></pre></div>
</div>
<div id="for-loop-1" class="section level4" number="4.7.2.2">
<h4><span class="header-section-number">4.7.2.2</span> <code>for</code> loop</h4>
<p>Here we apply our <code>for</code> loop. in each round, we:</p>
<ol style="list-style-type: decimal">
<li>Sample, with replacement and calculate average</li>
<li>Store average in <code>NatSims</code> (native species) or <code>IntSims</code> (non-native species)</li>
</ol>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="advanced-visualizations.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>IterN){</span>
<span id="cb382-2"><a href="advanced-visualizations.html#cb382-2" aria-hidden="true" tabindex="-1"></a>  NatSims[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sample</span>(NatSVals,<span class="fu">length</span>(NatSVals),<span class="at">replace=</span>T))</span>
<span id="cb382-3"><a href="advanced-visualizations.html#cb382-3" aria-hidden="true" tabindex="-1"></a>  IntSims[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sample</span>(IntSVals,<span class="fu">length</span>(IntSVals),<span class="at">replace=</span>T))</span>
<span id="cb382-4"><a href="advanced-visualizations.html#cb382-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="ci" class="section level4" number="4.7.2.3">
<h4><span class="header-section-number">4.7.2.3</span> 95% CI</h4>
<p>Confidence Intervals (CI) are calculated from the bootstrap output.</p>
<p>First, sort the datea from low to high</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="advanced-visualizations.html#cb383-1" aria-hidden="true" tabindex="-1"></a>NatSims<span class="ot">&lt;-</span><span class="fu">sort</span>(NatSims)</span>
<span id="cb383-2"><a href="advanced-visualizations.html#cb383-2" aria-hidden="true" tabindex="-1"></a>IntSims<span class="ot">&lt;-</span><span class="fu">sort</span>(IntSims)</span></code></pre></div>
<p>Each of the objects contains a number of values equal to our <code>Iter</code> variable defined above. Now we identify the lower 2.5% and upper 97.5% values in each vector. For example, with 1000 iterations our 2.5% would be the 25th value in the sorted vector and the upper 97.5% would be the 975th value in the sorted vector.</p>
<p>We use this number to index the vector with square brackets. We make sure to round to a whole number since we can’t have a fractional cell position.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="advanced-visualizations.html#cb384-1" aria-hidden="true" tabindex="-1"></a>CIs<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">sort</span>(NatSims)[<span class="fu">round</span>(IterN<span class="sc">*</span><span class="fl">0.025</span>,<span class="dv">0</span>)], <span class="co"># Native, lower 2.5%</span></span>
<span id="cb384-2"><a href="advanced-visualizations.html#cb384-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sort</span>(NatSims)[<span class="fu">round</span>(IterN<span class="sc">*</span><span class="fl">0.975</span>,<span class="dv">0</span>)], <span class="co"># Native, upper 97.5%</span></span>
<span id="cb384-3"><a href="advanced-visualizations.html#cb384-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sort</span>(IntSims)[<span class="fu">round</span>(IterN<span class="sc">*</span><span class="fl">0.025</span>,<span class="dv">0</span>)], <span class="co"># Intro, lower 2.5%</span></span>
<span id="cb384-4"><a href="advanced-visualizations.html#cb384-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sort</span>(IntSims)[<span class="fu">round</span>(IterN<span class="sc">*</span><span class="fl">0.975</span>,<span class="dv">0</span>)]) <span class="co"># Intro, upper 97.5%</span></span></code></pre></div>
</div>
</div>
<div id="plot-data" class="section level3" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Plot data</h3>
<p>We’ll combine the separate bootstrap vectors into a single data.frame object to make it easier to incorporate into our <code>ggplot</code> functions.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="advanced-visualizations.html#cb385-1" aria-hidden="true" tabindex="-1"></a>HistData<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">s=</span>SelData<span class="sc">$</span>s,<span class="at">Native=</span>SelData<span class="sc">$</span>Native)</span></code></pre></div>
<p>Now we can add layers to the plot. We’ll print out each layer as we go, so that we can see what each layer does. The coding is a bit complex here, so don’t worry if it’s hard to follow everything. The key thing to understand here is how the different geoms contribute to the final plot as individual ‘layers’.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="advanced-visualizations.html#cb386-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb386-2"><a href="advanced-visualizations.html#cb386-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="at">data=</span>HistData[HistData<span class="sc">$</span>Native<span class="sc">==</span><span class="st">&quot;yes&quot;</span>,], <span class="fu">aes</span>(s,<span class="at">y=</span>(..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..)),<span class="at">alpha =</span> <span class="fl">0.6</span>,<span class="at">colour=</span><span class="st">&quot;#1fcebd&quot;</span>,<span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb386-3"><a href="advanced-visualizations.html#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># native species histogram</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="advanced-visualizations.html#cb388-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="at">data=</span>HistData[HistData<span class="sc">$</span>Native<span class="sc">==</span><span class="st">&quot;no&quot;</span>,], <span class="fu">aes</span>(s,<span class="at">y=</span>(..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..)),<span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">colour=</span><span class="st">&quot;#f53751&quot;</span>,<span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb388-2"><a href="advanced-visualizations.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># introduced species histogram</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="advanced-visualizations.html#cb390-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>CIs[<span class="dv">1</span>],<span class="at">xmax=</span>CIs[<span class="dv">2</span>],<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span><span class="fl">0.01</span>),<span class="at">colour=</span><span class="st">&quot;white&quot;</span>,<span class="at">fill=</span><span class="st">&quot;#1fcebd88&quot;</span>)</span>
<span id="cb390-2"><a href="advanced-visualizations.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># native species 95% CI bar</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-3.png" width="672" /></p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="advanced-visualizations.html#cb392-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">mean</span>(NatSims),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.01</span>)),<span class="at">colour=</span><span class="st">&quot;#1d76bf&quot;</span>,<span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb392-2"><a href="advanced-visualizations.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># native species bootstrap mean</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-4.png" width="672" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="advanced-visualizations.html#cb394-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>CIs[<span class="dv">3</span>],<span class="at">xmax=</span>CIs[<span class="dv">4</span>],<span class="at">ymin=</span><span class="dv">0</span>,<span class="at">ymax=</span><span class="fl">0.01</span>),<span class="at">colour=</span><span class="st">&quot;white&quot;</span>,<span class="at">fill=</span><span class="st">&quot;#f5375188&quot;</span>)</span>
<span id="cb394-2"><a href="advanced-visualizations.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># introduced species 95% CI bar</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-5.png" width="672" /></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="advanced-visualizations.html#cb396-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">mean</span>(IntSims),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.01</span>)),<span class="at">colour=</span><span class="st">&quot;#f53751&quot;</span>,<span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb396-2"><a href="advanced-visualizations.html#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># introduced species bootstrap mean</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-6.png" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="advanced-visualizations.html#cb398-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>))</span>
<span id="cb398-2"><a href="advanced-visualizations.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p) <span class="co"># labels added, truncated x-axis</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).

## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-34-7.png" width="672" /></p>
<p>Another important point to note is that case we leave the <code>ggplot()</code> function empty because each geom uses different data. The data for each geom is defined by separate <code>aes</code> functions inside of each geom.</p>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
<div id="multi-graph" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Multi-graph</h2>
<p>In the <a href="https://colauttilab.github.io/RCrashCourse/2_qplot.html">qplot Tutorial</a> we saw a quick and easy way to make multiple graphs for different groups using the <code>facets</code> parameter.</p>
<div id="facets-1" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> <code>facets</code></h3>
<p>We can also use facets with <code>gpplot</code>, just using a slightly different syntax giving a couple of options:</p>
<ol style="list-style-type: decimal">
<li><code>facet_grid</code> lets us define a grid and set the vertical and horizontal variables</li>
<li><code>facet_wrap</code> is a convenient option if only have one categorical variable but many categories</li>
</ol>
<p>NOTE: one little tricky part of facets with <code>ggplot</code> is that it uses <code>vars</code> instead of the <code>aes</code> function to indicate which categorical variables from the original dataset should be used to subset the graphs.</p>
<p>Returning to the <code>BivPlot</code> example above:</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="advanced-visualizations.html#cb404-1" aria-hidden="true" tabindex="-1"></a>BivPlot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>SelData, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(s<span class="sc">+</span><span class="dv">1</span>), <span class="at">y=</span>Rpoint)) <span class="sc">+</span> </span>
<span id="cb404-2"><a href="advanced-visualizations.html#cb404-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb404-3"><a href="advanced-visualizations.html#cb404-3" aria-hidden="true" tabindex="-1"></a>BivPlot <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="at">rows=</span><span class="fu">vars</span>(Native), <span class="at">cols=</span><span class="fu">vars</span>(Collector))</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="advanced-visualizations.html#cb405-1" aria-hidden="true" tabindex="-1"></a>BivPlot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>SelData, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(s<span class="sc">+</span><span class="dv">1</span>), <span class="at">y=</span>Rpoint)) <span class="sc">+</span> </span>
<span id="cb405-2"><a href="advanced-visualizations.html#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb405-3"><a href="advanced-visualizations.html#cb405-3" aria-hidden="true" tabindex="-1"></a>BivPlot <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Year))</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="grid.extra-package" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> <code>grid.extra</code> package</h3>
<p>Facets produce graphs with the same x- and y-axes. We might call these ‘homogenous’ plots because they use the same axes and they are all the same size. For publications though, we might want to includ ‘heterogeneous’ plots with different axes and different sizes. The <code>gridExtra</code> package provides options for this.</p>
<p>Install ‘gridExtra’ with <code>install.packages("gridExtra")</code></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="advanced-visualizations.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<div id="grid.arrange" class="section level4" number="4.8.2.1">
<h4><span class="header-section-number">4.8.2.1</span> <code>grid.arrange()</code></h4>
<p>Use this to combine heterogeous ggplot objects into a single multi-panel plot.</p>
<p>Note that this will print ghe graphs graphs down rows, then across columns, from top left to bottom right. You can use <code>nrow</code> and <code>ncol</code> to control the layout in a grid format.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="advanced-visualizations.html#cb407-1" aria-hidden="true" tabindex="-1"></a>HistPlot<span class="ot">&lt;-</span>p <span class="co"># Make a more meaningful name</span></span>
<span id="cb407-2"><a href="advanced-visualizations.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(HistPlot,BivPlot,BarPlot,<span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="advanced-visualizations.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(HistPlot,BivPlot,BarPlot,<span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<blockquote>
<p>Note: You might get some warnings based on missing values or wrong binwidth. You will also see some weird things with different text sizes in the graphs. Normally, you would want to fix these for a final published figure but here we are just focused on showing what is possible with the layouts.</p>
</blockquote>
</div>
</div>
<div id="grid-package" class="section level3" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> <code>grid</code> package</h3>
<p>What if we want to have graphs of different sizes? Or what if we want one figure to be inside another? We can make some even more advanced graphs using the <code>grid</code> package.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="advanced-visualizations.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span></code></pre></div>
<p>First, we set up the plotting area with <code>grid.newpage</code></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="advanced-visualizations.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.newpage</span>() <span class="co"># Open a new page on grid device</span></span></code></pre></div>
<p>To insert a new graph on top (or inside) the current graph, we use <code>pushViewport</code> to set up an imaginary plotting grid. In this case, imagine breaking up the plotting space into 3 rows by two columsn.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="advanced-visualizations.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(<span class="dv">3</span>, <span class="dv">2</span>))) <span class="co"># Create 3x2 grid layout</span></span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Finally, we print each <code>ggplot</code> object, specifying which grid(s) to plot in.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="advanced-visualizations.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(HistPlot, <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> <span class="dv">3</span>, <span class="at">layout.pos.col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)) <span class="co"># Add fig in row 3 and across columns 1:2</span></span>
<span id="cb412-2"><a href="advanced-visualizations.html#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BivPlot, <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">layout.pos.col =</span> <span class="dv">1</span>)) <span class="co"># add fig acros rows 1:3 in column 1</span></span>
<span id="cb412-3"><a href="advanced-visualizations.html#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BarPlot, <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">layout.pos.col =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div id="inset" class="section level4" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> Inset</h4>
<p>We can also use <code>pushViewport</code> to set up a grid for plotting on top of an existing graph or image. This can be used to generate a figure with an inset.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="advanced-visualizations.html#cb413-1" aria-hidden="true" tabindex="-1"></a>HistPlot</span>
<span id="cb413-2"><a href="advanced-visualizations.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(<span class="dv">4</span>, <span class="dv">4</span>))) <span class="co"># Create 4x4 grid layout (number of cells, will determine size/location of graph)</span></span>
<span id="cb413-3"><a href="advanced-visualizations.html#cb413-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(BivPlot, <span class="at">vp =</span> <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">layout.pos.col =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>))</span></code></pre></div>
<p><img src="03_ggplot_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
</div>
<div id="further-reading" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Further Reading</h2>
<p>The 2009 book <em>ggplog2: Elegant Graphics for Data Analysis</em> by Hadly Wickham is the definitive guide to all things ggplot.</p>
<p>A physical copy is published by Springer
<a href="http://link.springer.com/book/10.1007%2F978-0-387-98141-3" class="uri">http://link.springer.com/book/10.1007%2F978-0-387-98141-3</a></p>
<p>And there is a free ebook version: <a href="https://ggplot2-book.org/" class="uri">https://ggplot2-book.org/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quick-visualizations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regular-expressions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03_ggplot.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
